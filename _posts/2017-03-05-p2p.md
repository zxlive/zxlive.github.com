---
layout: post
title:  "2年和10天，P2P实验终于成功了"
date:   2017-03-05
categories: Working
author_name: 晓龙
author_url: /author/zxl
author_avatar: zxl
feature_image: succeed
---
### 点对点udp通讯终于打通了，一共花了10天时间。但这个结果等了2年！  
    
这个关键技术，在2年多前就开始关注，尝试，却一直没有做出来。  
一直没有做出来的原因，是因为觉得太难，然后还考虑各种风险，担心花了那么多时间精力白费，不能赚钱。  
看了稻盛和夫的《京瓷哲学》，知道这其实是“自私自利”的行为，因为难度太大，而且担心不能赚钱就不去做。  
对我来说，这个观点真是醍醐灌顶。  
我一向以为自己不是一个自私的人，原来很多项目最终没做下去，都是因为自私的原因，太麻烦了，可能不赚钱，还是找轻松能保险来赚钱的项目来做吧，后果就是好多不错的产品都没有深度挖掘，毕竟太难了嘛。然后就去做那些所谓轻松的产品，做了2年后发现，这几个产品是做出来了，但并不像以前那样一炮而红，然后就不继续做了，就因为选材的初衷是自私的目的--“能赚钱”。 
 
### 但这次为什么花10天就把P2P打洞做出来了呢？  

   稻盛和夫说的“私心了无”，目标不是自私自利时，才能克服各种困难，关键是我心态的变化，才能坚持把这个实验做成。  
   难度在一开始就预见了，需要3端调试，一台服务器，两个手机，调试程序时，需要更新3个设备，头脑要考虑多设备多进程的时序，十分繁琐。用到了Go和Goroutine并发，涉及多线程和Channel的启用和关闭，也很麻烦。还需要专门的路由器做实验，还需要刷第三方的固件，然后买的第一台还有奇怪的问题，搞了半天才发现不是软件的问题，是意外的硬件故障。这些都可谓困难重重。但这个时候的心态是铁了心要做出来，所以遇到这些困难一个个克服，也就不会像以前那样一遇到困难就停了下来。  

### 关键不是遇到的问题有多难，而是面对困难时的心态。  

我的心态是怎么样的呢？  
如果玩家能联机，那他玩游戏一定会很开心。就算Apple等审核政策的原因不让用VPN，我最终也要在我的游戏中使用这项技术，所以没有什么可以挡住我的，何况这项技术不仅仅是应用在这个产品中，其他摄像头，家电控制等领域都会用到这项技术。  
   以前光考虑赚钱的话，一碰到困难就躲开了，毕竟还有更多安逸的事情可以做。如果目的更加崇高，私心了无。不去考虑自己个人得失，只考虑这个任务的长远意义，就不会遇到困难就躲了。  

### 当心态变化积极面对困难的时候，还带来了一些意想不到的好处！ 

#### 首先，积极面对困难的时候，困难反而变简单了。  

   网上关于P2P的文章都是理论文章，浮于表面，没有实际操作，都是一些书面文章。  
这类文章只会把简单问题复杂化，让困难显得更难。以前看了这些文章，看得越多，越不敢做，就好像面对的困难是座大山一样。  
   然后，为了实际解决这个难题，我开始想各种办法，甚至抱着试一试的态度给一位P2P作者写邮件询问。如果是以前，我是懒得问的，认为对方也许根本就不回呢。但这次我想，我只是写几个字，对方就算不回复我也没损失，万一回了呢。很意外的，对方给了我答复，他用很简单巧妙的方法就实现了80%的打洞成功率，根本就没用网上的那些麻烦复杂的方法。  
   有了这个实际经验的指引，我的信心倍增。  
   积极面对困难的时候，困难反而变简单了，因为积极想办法，困难会一个个解决。
逃避困难的时候，难题好像会越积越大，就好像永远难于跨越一样。  
   逼到绝境，才会尽全力，才会在有限的资源里，迸发出绝妙的解决方案。安逸的环境下不会尽力，只会拖延，尽想那些浮华的解决办法。  

#### 积极面对困难时，现在的竞争对手和未来的风险都不算什么了。

XBOX账号已经提供了这个P2P联机功能，我还是不做了吧。这个是自私的理由。
XBOX的联机功能不好用，国内的孩子没有VPN根本连不上，而且还是基于熟人联机的，使用率太低了。我要开发的不一样，要更好玩。这个是利他的理由。  

其他的APP已经有联机功能了，我还是别做了吧。这也是自私的理由。
他们的联机功能还是不够好，问题多多。我还是要有自己的玩法，做得不一样。孩子们一定喜欢。何况，我还有更高的目标，我想要的是社区，不仅仅是联机。  

### “最后通牒”针对拖延症很有效

在到第10天，最初的激情开始降低了，我知道这是我热情维持的周期快到了！  
我有些累了，该做的实验迟迟没有动手，一直在做外围的准备工作，磨磨唧唧。  
这个时候，我在任务表第一条写了：今天是打洞最后一天。  
我就想着，如果实在不想做，就先换其他项目，等有了兴趣再换回来。  
但奇怪的事情发生了，既然是最后一天了，那就好好开始干吧，反而轻松了下来。然后就把乱七八糟的事情先停了下来，先把手机端的代码搭起来了，然后三下五除二，就可以实验了！
本来就是乱七八糟，一开始哪里会有完美的，所以干脆乱七八糟搭起来得了。
第一次联调的结果结果也不意外，收不到数据不通讯，原因也不清楚。
但乱七八糟本来就不应该马上就通的，反而静下心来，找出各种可能性，一个个排除，一个个验证。   
在这期间，突发奇想，找来另外一台笔记本电脑，先扔掉那堆乱七八糟的实验环境，用一个udp的app直接手动做打洞实验，然后就打通了，这个时候信心倍增，说明逻辑算法正确。然后再回来把那堆乱七八糟的实验环境理顺了，很快就在晚上把整个app的p2p通讯成功都搞定了。  

### 面对未知的问题，不要追求完美解决方案。乱七八糟反而是针对未知的最佳解决方案。

从上文想到的，面对未知的问题时，我总想先拿出完美的解决方案，这是我的思维定势。
但既然问题还是未知，我还不了解问题的细节原貌，我要是能事先就想出完美解决方案，那就是瞎扯淡嘛。  
应该是先搞一堆乱七八糟的实验环境，然后根据问题的反应，再不断修改，做到完善完美，这个是符合逻辑的。
